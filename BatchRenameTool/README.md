# 批量文件重命名工具 (BatchRenameTool)

一个功能强大的批量文件重命名工具，基于PyQt5开发，支持多种重命名规则、元数据提取和智能重命名功能。

## 🚀 功能特性

### 📁 文件管理
- **拖放支持**: 支持文件拖放到界面
- **批量添加**: 支持添加文件和文件夹
- **文件预览**: 实时显示重命名前后对比
- **状态跟踪**: 显示每个文件的重命名状态

### 🔧 重命名规则
- **替换规则**: 替换文件名中的指定文本
- **插入规则**: 在指定位置插入文本
- **删除规则**: 删除文件名中的指定字符或位置
- **序列规则**: 添加序号、日期等序列信息
- **正则表达式**: 使用正则表达式进行复杂匹配和替换
- **元数据规则**: 基于文件元数据重命名
- **智能重命名**: 自动识别电视剧集、照片日期等

### 📊 元数据提取
- **图片文件**: 提取EXIF信息（拍摄时间、相机型号等）
- **音乐文件**: 提取ID3标签（艺术家、专辑、标题等）
- **文件属性**: 提取创建时间、修改时间、文件大小等

### 🧠 智能重命名
- **电视剧集识别**: 自动识别S01E02、第01集等格式
- **照片日期整理**: 根据拍摄时间整理照片文件
- **自动识别模式**: 智能判断文件类型并应用相应规则

### 🔄 操作管理
- **撤销/重做**: 完整的操作历史管理
- **规则模板**: 保存和加载常用规则组合
- **实时预览**: 应用规则前预览效果
- **冲突处理**: 自动处理文件名冲突

## 📋 系统要求

### Python版本
- Python 3.7+

### 操作系统
- Windows 10/11
- macOS 10.15+
- Linux (Ubuntu 18.04+)

## 🔧 安装说明

### 1. 克隆或下载项目
```bash
git clone <repository-url>
cd BatchRenameTool
```

### 2. 安装依赖包
```bash
pip install -r src/requirements.txt
```

### 3. 运行应用程序
```bash
cd src
python main.py
```

## 📦 依赖库说明

| 依赖库 | 版本 | 功能说明 |
|--------|------|----------|
| PyQt5 | >=5.15.0 | GUI框架，提供用户界面组件 |
| Pillow | >=9.0.0 | 图像处理，用于提取图片EXIF数据 |
| mutagen | >=1.45.0 | 音频文件元数据提取 |
| python-magic | >=0.4.24 | 文件类型识别 |
| regex | >=2023.3.23 | 增强的正则表达式支持 |

## 🎯 使用方法

### 基本操作流程

1. **启动应用程序**
   ```bash
   cd src
   python main.py
   ```

2. **添加文件**
   - 点击"添加文件"按钮选择文件
   - 点击"添加文件夹"按钮选择整个文件夹
   - 直接将文件拖放到界面中

3. **配置重命名规则**
   - 在中间面板选择规则类型
   - 配置规则参数
   - 点击"添加规则"将规则添加到规则列表

4. **预览效果**
   - 右侧面板实时显示重命名预览
   - 检查是否符合预期

5. **执行重命名**
   - 点击"执行重命名"按钮
   - 系统会显示重命名进度和结果

### 规则配置示例

#### 替换规则
- **查找文本**: "old_text"
- **替换为**: "new_text"
- **效果**: `file_old_text.jpg` → `file_new_text.jpg`

#### 序列规则
- **起始序号**: 1
- **步长**: 1
- **格式**: "###"
- **效果**: `file.jpg` → `file_001.jpg`

#### 元数据规则
- **类型**: "拍摄时间"
- **格式**: "YYYY-MM-DD_HH-MM-SS"
- **效果**: `IMG_1234.jpg` → `2023-12-01_14-30-25.jpg`

#### 智能重命名规则
- **类型**: "电视剧集"
- **效果**: `S01E02.mkv` → `S01E02.mkv` (保持原格式)

## 🏗️ 项目结构

```
BatchRenameTool/
├── src/
│   ├── main.py              # 主程序文件
│   ├── requirements.txt     # 依赖包列表
│   └── templates/          # 规则模板目录（自动创建）
├── README.md               # 项目说明文档
└── .gitignore             # Git忽略文件
```

### 主要类说明

- **BatchRenameTool**: 主窗口类，管理整个应用程序
- **FileItem**: 文件项类，存储文件信息和状态

### 核心方法

- `apply_rules()`: 应用重命名规则到文件名
- `execute_rename()`: 执行重命名操作
- `undo_rename()`: 撤销重命名操作
- `redo_rename()`: 重做重命名操作
- `smart_rename()`: 智能重命名功能
- `extract_metadata()`: 提取文件元数据

## 🔍 高级功能

### 规则模板管理
- **保存模板**: 将当前规则组合保存为模板
- **加载模板**: 快速应用预定义的规则组合
- **分享模板**: 导出模板文件与他人分享

### 智能识别功能
- **自动文件类型检测**: 根据文件内容识别类型
- **模式匹配**: 智能识别常见命名模式
- **批量处理优化**: 优化大量文件的处理性能

### 错误处理
- **文件冲突检测**: 自动处理重名文件
- **权限检查**: 检查文件读写权限
- **异常捕获**: 友好的错误提示信息

## 🐛 常见问题

### Q: 程序无法启动，提示模块未找到
A: 请确保已安装所有依赖包：
```bash
pip install -r src/requirements.txt
```

### Q: 重命名操作失败
A: 检查文件是否被其他程序占用，或是否有足够的权限

### Q: 元数据提取失败
A: 某些文件可能不包含元数据，或文件格式不受支持

### Q: 智能重命名效果不理想
A: 可以尝试调整识别参数或使用正则表达式进行精确匹配

## 🚧 开发计划

- [ ] 支持更多文件格式的元数据提取
- [ ] 添加批量预览和选择性重命名
- [ ] 支持命令行模式
- [ ] 添加插件系统
- [ ] 多语言支持

## 🤝 贡献指南

欢迎提交Issue和Pull Request来改进这个工具！

### 开发环境设置
1. Fork项目仓库
2. 创建功能分支
3. 提交更改
4. 推送到分支
5. 创建Pull Request

### 代码规范
- 遵循PEP 8编码规范
- 添加适当的注释
- 编写单元测试
- 更新文档

## 📄 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 📞 联系方式

如有问题或建议，请通过以下方式联系：
- 提交GitHub Issue
- 发送邮件到项目维护者

---

**注意**: 使用前请备份重要文件，重命名操作不可逆。建议先在测试文件上验证规则效果。